library ieee;
use ieee.std_logic_1164.all;
use ieee.numeric_std.all;

entity Divisor is
  port (
    dividendo : in unsigned(31 downto 0);
    divisor : in unsigned(15 downto 0);
    coeficiente : out unsigned(15 downto 0);
    resto : out unsigned(15 downto 0)
  );
end Divisor;

architecture Main of Divisor is
begin
  process(dividend, divisor)
    variable dividend_var : unsigned(31 downto 0);
    variable divisor_var : unsigned(15 downto 0);
    variable quotient_var : unsigned(15 downto 0);
    variable remainder_var : unsigned(15 downto 0);
  begin
    dividend_var := dividend;
    divisor_var := divisor;
    
    for i in 15 downto 0 loop
      quotient_var(i) := '0';
      remainder_var := remainder_var & dividend_var(31);
      dividend_var := shift_left(dividend_var, 1);
      
      if remainder_var >= divisor_var then
        quotient_var(i) := '1';
        remainder_var := remainder_var - divisor_var;
      end if;
    end loop;
    
    quotient <= quotient_var;
    remainder <= remainder_var;
  end process;
end Main;